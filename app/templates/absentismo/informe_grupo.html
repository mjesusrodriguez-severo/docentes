{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h4 class="mb-3 text-burdeos">
    <i class="bi bi-person-lines-fill"></i> Informe de {{ grupo.nombre }} – {{ mes|capitalize }} {{ anio }}
  </h4>

  <table class="table table-sm align-middle mt-3">
    <thead class="table-secondary">
      <tr>
        <th>Alumno/a</th>
        <th>CJ</th>
        <th>CI</th>
        <th>% CI</th>
      </tr>
    </thead>
    <tbody>
      {% for ia in informe.alumnos %}
        {% set alumno = ia.alumno %}
        <tr {% if ia.porcentaje_injustificadas >= 20 %}class="table-warning"{% endif %}>
          <td>{{ alumno.nombre }} {{ alumno.apellidos }}</td>
          <td>{{ ia.faltas_justificadas }}</td>
          <td>{{ ia.faltas_injustificadas }}</td>
          <td>{{ "%.1f"|format(ia.porcentaje_injustificadas) }}%</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="mt-3 d-flex flex-wrap gap-2">
      <a href="{{ url_for('main.ver_absentismo_mes', mes=mes) }}" class="btn btn-outline-secondary btn-sm">
        <i class="bi bi-arrow-left"></i> Volver al listado general
      </a>
      <a href="{{ url_for('main.descargar_informe', grupo_id=grupo.id, mes=mes) }}" class="btn btn-outline-dark btn-sm">
        <i class="bi bi-download"></i> Descargar informe
      </a>
      <form method="POST"
            action="{{ url_for('main.borrar_informe', grupo_id=grupo.id, mes=mes) }}"
            onsubmit="return confirm('¿Seguro que quieres borrar este informe?');"
            class="d-inline">
        <button type="submit" class="btn btn-outline-danger btn-sm">
          <i class="bi bi-trash"></i> Borrar informe
        </button>
      </form>
    </div>
</div>
{% endblock %}